<html>
  <head>
    <script>
      function syntaxHighlight(json) {
        json = JSON.stringify(JSON.parse(json), undefined, 2);
        json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
          var cls = 'number';
          if (/^"/.test(match)) {
            if (/:$/.test(match)) {
              cls = 'key';
            } else {
              cls = 'string';
            }
          } else if (/true|false/.test(match)) {
            cls = 'boolean';
          } else if (/null/.test(match)) {
            cls = 'null';
          }
          return '<span class="' + cls + '">' + match + '</span>';
        });
      }

      window.onload = () => {
        document.getElementById('settings').innerHTML = syntaxHighlight(document.getElementById('settings').innerText);
      }
    </script>
    <title>VWO server-side Experimentation</title>
    <style>
      .center {
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .margin--top {
        margin-top: 20px;
      }

      .color-grey {
        color: #777;
      }

      .color-blue {
        color: #00a8ff;
      }

      button {
        background: #fff;
        padding: 10px 20px;
        color: #777;
        border: 2px solid #777;
        font-size: 18px;
        text-decoration: none;
      }
      button.v1 {
        border: 2px solid #ff9a9a;
      }
      button.v2 {
        border: 2px solid #57e0a2;
      }
      button.v3 {
        border: 2px solid #00a8ff;
      }

      pre {
        background-color: ghostwhite;
        border: 1px solid silver;
        padding: 10px 20px;
        max-height: 80vh;
        overflow: auto;
      }
      .json-key {
        color: brown;
      }
      .json-value {
        color: navy;
      }
      .json-string {
        color: olive;
      }

      .main-container {
        display: flex;
        width: 100%;
        height: 100%;
        max-height: 100%;
      }
      .left-container {
        flex: 0 1 50%;
        min-height: 100%;
        max-width: 50%;
        margin: 0 10px;
      }
      .right-container {
        flex: 0 1 50%;
        display: flex;
        height: 100%;
        max-width: 50%;
        flex-wrap: wrap;
        align-items: flex-start;
        margin: 0 10px;
      }
      .half-containers {
        flex: 0 0 100%;
        max-height: 50%;
        min-height: 50%;
        max-width: 100%;
        overflow: hidden;
      }
      pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; }
      .string { color: green; }
      .number { color: darkorange; }
      .boolean { color: blue; }
      .null { color: magenta; }
      .key { color: red; }
    </style>
  </head>
  <body>
    <div>
      <h2 class="center  color-blue">VWO Ruby SDK Example</h2>
      <div class="main-container">
        <div class="left-container">
          <h2 class="center  color-grey">Settings</h2>
          <pre id="settings"><%= settings_file %></pre>
        </div>

        <div class="right-container">
          <div class="half-containers">
            <h2 class="center  color-grey">Details</h2>

            <div class="center  margin--top">
              <div>Campaign test key - <strong><%= ab_campaign_key %></strong></div>
            </div>
            <div class="center margin--top">
              <div>Campaign goal identifier - <strong><%= ab_campaign_goal_identifier %></strong></div>
            </div>

            <div class="center  margin--top">
              <div>User ID - <strong><%= user_id %></strong></div>
            </div>

            <%  if part_of_campaign %>
            <div class="center  margin--top">
              <div>variationAssigned - <strong><%= variation_name %></strong></div>
            </div>
            <%  else %>
            <div class="center  margin--top">
              <div>did not become a part of campaign</div>
            </div>
            <% end %>
          </div>
          <div class="half-containers  center">
            <%  if (variation_name == 'Control') %>
              <button class="v1">Control</button>
            <% elsif (variation_name == 'Variation-1') %>
              <button class="v2">Vartion 1</button>
            <% elsif (variation_name == 'Variation-2') %>
              <button class="v3">Variation 2</button>
            <% else %>
              <button>Not part</button>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
